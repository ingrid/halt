#load "nums.cma";;
open Big_int;;
open List;;

let p l = match l with [] -> (0,[]) | x::xs -> (x,xs);;

let g (l,m,r,s) = let (mn,ln) = p l in (ln,mn,m::r,s);;

let d (l,m,r,s) = let (mn,rn) = p r in (m::l,mn,rn,s);;

let print_id t (l,m,r,s) =
  Printf.printf "%s%s[%d]%s then apply %s (s = %d)\n" 
    (String.make (2 * (40 - List.length l) + if l == [] then 0 else 1) ' ')
    ((String.concat " " (List.rev (List.map string_of_int l)))) m
    (String.concat " " (List.map string_of_int r)) t s;
  (l,m,r,s) ;;

let rec f (l,m,r,s) = ignore (print_id "f" (l,m,r,s)) ;
  match (m,s) with
	(0,0) -> f (d (print_id "d" (l,1,r,1))) |
	(0,1) -> f (d (print_id "d" (l,1,r,2))) |
	(0,2) -> f (g (print_id "g" (l,1,r,3))) |
	(0,3) -> f (d (print_id "d" (l,1,r,4))) |
	(0,4) -> f (g (print_id "g" (l,1,r,0))) |

	(1,0) -> f (g (print_id "g" (l,1,r,4))) |
	(1,1) -> f (d (print_id "d" (l,1,r,5))) |
	(1,2) -> f (d (print_id "d" (l,0,r,1))) |
	(1,3) -> f (g (print_id "g" (l,0,r,2))) |
	(1,4) -> f (d (print_id "d" (l,0,r,3))) |
	(1,5) -> f (d (print_id "d" (l,1,r,2))) |
	(_,_) -> (l,1,r);;

let u = fold_right add_int_big_int;;

(* let a = let (l,m,r) = f ([],0,[],0) in u r (u l (big_int_of_int m));; *)

(* print_endline (string_of_big_int a);; *)
print_endline "3514749525237646314855546771114364755767274625926325736213218928820741221261252342696134490334047942741588740855741617586408710260076895085680158939481661736905182970918861692282087176318946430402988420114923841803314050578696912682707858206715741041417606792520975965892560023939884350490300429629960832859858445249158494260182677698091220368959663668603954175797097689265127461159832047501137152726132966334187625913787977712688179898214735574466580554672127722152833492846332019055432943760330973562614275563256082439609073071574542354046698495209347164836966698517855721231290561417684453752267303520466700441255151673543115085699333242959377119007518198828449361850684163180012165557935250830102155612349746514745608062594062269232633132564350889847442385787770841546594667705919886308861091017853759613456348210423340980584719251582866309840147533286925431154554934152652971546168908132895716893884586890356846886222811555113312296937507328569341516410688605240766787559744961818407414799983992066559285567393647841519821495470617904423403499081015232746092377721939255097243901251824117814278737859266659793419090062712148265949236095156172946740959158249463186554142899200943296554106735967531441671407013404947168402851988079456087640834427959552753930808773657643706467206098028110178109513339169500682752331518582273681204616177532957682565774134165669085997549398310710634971777199336353636662325243215113614540536886962877004611359666216854550918608967161549091717112123461270933410653692601106783855774094127691480548853699694287742566891909858885289059825119110077344384977588561623933720476057441686885459110884877834166480918448643497252738694086249345049644278655670909340595143763901219622320519072044427795692044757765238440648408145863182383957118167950728628636626316423022816155005058696439110432452127446725565292317430565424197122730094400198823220956985927543987437041948715290696481233968372927584469732494969610250694260301056284611374690329386854702042065560591031321568103564818322881780346206742136440107968150032548169659492436761587572900316910315119391809387739253964502410941205728088308243961234927292390262544910903195950051893841591744871613800278221791627890716031507624712184325610354321773610592667029670127060558123934901108290151439790998029183670108877692492393333169629552334980056251493696832383243356120318806482597665683037000080827857758644781969304493269339648421026294345757304463010279431019195117128321626851907866809136460866199256977426755389555129254963471255837273427910352636669709081766931118000911892043105920232035164246343219848966573530558311307854178870410038846575807822363697474924422176496933878685765514673755389833451913422763489169103664520005719543275418637500144647268959615825171661607487314458436918886725879482798921538491245566519747086176231867023917632385286132180076927300536107070095588258870857434637609190801291690408230182981956289264001517830293213549981813878674382305954120312741992596476215410129852757075579308762022752350919456248135201554028204279333300778721378491803946496203326949318849134086197900438081214875341780349008676136582268422318849044370263512085099126193875217445907743485816308307645838801048792297882650936236415118797613257809414464770307883241831872603441486521334773111868196051632367739868717433682711715240857180877066520497017149298840793122238628773301800047538500631687123056517590555612762726251378072603037192844055605005053067939402441415531982782069464119467638541320532674123655715949470351267526763698572384443123155601462022205593925324762400796418405934453743407120174124198065604704965732334381588444075799103972634889941116415585139509865834289491362051018053650005533811244818134159746627119171918635696664594846645682228453137127499918498685456558671362386114269128046977840285593647042470015346867811240853179097558465227257718216447816565802484456843333193759115708815715272175242770811635565722327748922845092650551035210236817998451758552136738660439006685527887130124609477112214664167704463475603999912892948246982102212277095720060557196669464997709731745502593759112534776537159853819706528420132103220446214361272648735286558062621623257691143444514658852854398106753176463197804223941724549823662836882418444206025781947795791252947167658698363076817262385131035417508353131445563622540952048171746806703950039947394422668950671336946882075585835822032211832371502574287198095762942333717547287166227428244340113630288646487030978843807979256709751169356360655483004662233014078295399215780830992847973606065932950421410268194466585727334449480070342319050687163637360569246878365099483989564749277302536826774878102575663954441752795072906798132037793883847721866959065508666082662609713491204998218858462738609025519313095252093159844126794565296371807780267387870427382037593584470173154176924091295667828864285930621754819628558116924035143213978939649161524372682268157757442605757970146946363248764925592940436674956407164338267310980570402020999987992760477479860584172687101902869610598946587131690764743745577593368518031558628118420988548362411575804644322332359300175421009102408562569778695529784780841262422288416660925739928708983654937681733201979833667084678157233188877960684537008169789184794647955730357778448200678257176949221710094783948627553968457609578862786080082273204665830926868867182123455301708537391328633345814856629390660100475924239166063359818343100301094289897306962838814993868464215376127380358154518813936733565993726641743541163461064298566606341485635015478309584231382265815778107627941611885306754764014312976113037371818189152018817383826551010392760178031817245725640616388621501003799079514856210995982627162113675560347422031113499582849887740485969669427564235218590806494292853620285725522315768212192095393065513114541337550996050293257286605116371196566603450894214507805101557644656137213855806360151739099293003378180003371811957214241931521001549089914921638939624064849805992160263676864701598830790388902464705728869892089061018897271397003705002566306024139286956904626942664363292584857913842343586082086524548585312419861137584274518928469724584443750608695147076658285181999846565695419514189954642813691991792592529920386333178721200158673826585297830446859252553713186974540970340820730166111337665865208472512929136588800997495925582920481928602010911911711564135173995932009083770796006529351162859838266730398603304769544048846035750224434947929759796912561184944100492021788240150510259522154643155583438399065561139305227772734183561730963425915031868915831289599612855361702989087511977581116478953163253172756529262179673164208089578778253488826050156494798549759468076064174742837802336519245596322719461022110695238619828595910650993719327382647112947361317946914160113488406166936605001208490839239500131373838749801807116182690857599363232635544710598807871653366144698451130414393266691517446163692910639144933878477416396771028198975579705599479457719250849499017216945835485855074398828469679970044907303915191321292060539922211950279422513765259001211336780915041641363979610809673130013196328201770316586576722064880331648722745260815935992003032181032081660786478947470376519060640108503950974333492992796612874839150297815566011627637709716352619707091843404310596464802177490060279545104087386457519221538417554595161836162200175168879791126867784366999770072210602914905689199960180159800286367125687477552066863524551468900631854383378385091315784451815627605639862881719546119295517113596380803213031326916934333050394702170039536163417445554693524928608812130408969631600401541113145510825661751354463520165481854743265259745077395067783203248937894671148522782708019963811319287582612604267157536635088862141276913090531055323172793932765058909509765842901467706906670026005694168025636397552352542160144755884063305272260678023509837585551183143469724628086534756193070658091698840871546444462699489889132182794025273297029779448747747429369947229195586554679466215897838142582113382428326438379994348211948623866177140995460917289861946344583688967970562345361441986364572656836457922355051450380644079527703248343552600791648389653929910708341445710397556903077090254763164034228481496807882192236370015693929299967654509942663064280210450226190796946182553447667099677989819685079194024616602332186914344637215688205807904428475953732491101599116206876588301246024986271566113497657430018162114970147678967516933708041440075498334764864369737447588990044120962752250043946566370797761205969271336815613270357848065120108967556238063292235134821799653782319077820266573436025438429495741392474837169658421880178254731396898225034377630469842075871633153562593998380817096038859699258699112852992941027264415868444105132500457390646457285237656842720271098878277361851275151680651198674753477465673688400917971671013164669872137206996823069114043845527685622303217639223260268203090873253625004573187410652131460728308875028276469666915782382550728610712384014501446082428710077673350234355260257396849341792336008845320707616447412830281952675472996651866262981821313105972717592653364818198402810637727677101276715689077330381211406636711545993477949147631877083026193996908744645297171887060637783167435341377497160154407934731066168115628898130877336045627845179214292785384728759720014400291559986661699036275293805999693388405948133061574365530520730494660190902878375947678737962316662180245175806920449489254422056258307646316793774927126962400193106352563582651541833392769379263829405452149348111687782129822204931902739068514740581125111337072463184702895298872601526336113309335966247139010951806714577187158730068193256589880226155466416058993998370537500018787945059429812251843943876556816235303086848118687306554011754147231829812237580536873030452381744254333401424292832326813948787858920473027839543535128306914931655100305170784469963459358372529589133368970218485418448537263959307843370296215041894259944615671056152125137938681085948333812735103693315819262830878967703906568003120428553805236022128710652420005414843675392194321584834519798900094478641413163852711305567849526137314180657351962773927208801278971946737426959143798599677152984694065395832624211344572421871512366779596373090536308947029082698134519967699122283319354687001061079663770393391901582318613397823378918390764113406594452580439023834575622135865820358964479352777221378557373261813657532635015530413498844405132311353861246181126461869263296761474854685042277570259630537413793823094876426698014648532136390230769246605611679030189671453824800744759911390505839279850384404956585698972334886934939663260360830764587269888765960438601502445261271127127862211389491048747720505832291493749779276324357165963691605968420924881508474361306939337262136214885515542014724069839549680114104412116182894308189144527520904561746942787863538786483571803073782409939219549222466535846635390812600049039086793510946756503822058547911705535353563926645869187984530586087573915094402991154413006098447900202591951116635775884647242969831707438309151871246322329066966437988884007309074497525385069852390904224480602672615333741077504410769281903983567511752284498818314575554294850446581111471023075662829629334475163395238497538278756552667101802159201499027680333374616326813326474808732750612907661650686081045331815098167409896755475880971204591758582108722295780345828966385907350437181218388666673177205178974330116508120658005334778217129751969378368497231415044702111142646113475493789236945630605906812948207662283702977371628835448279018694212177142830224927039666534164584624373883993719753333487688710911485326550343970990177347615840922903172219088893960921038914869139441429315019277408408774989482924482675407094572893330851924027701223159193334869919594993806226556250372986659821581210385236198553119984562663858099842825770587668181553448590728151796417131900737274574801183758867147218984105182020457654271154010872791746716223574253931782120386892705425522144662023108117255287549673390938825543296979015583175702818536438231517918724799404912746332205903799340346061616572271764895513945355676291803198983063986732143531116264597522379206943928015909211978101489222444378788374586552025749516091251126772975809663812699191330255843510513188035358743348254959276580133837978845405985755206327052321661793723476760262808514399311810195196301150594243192523184855353501088241400321475135644383666896067827782699658015857127730394202437010957103526116717105617770447999076774555663497541152845335887709148405405510300773516454868737359169287075161702556257226999141358071114357778754386216237590062589377050769892399587811215476336464877280721010587375779137401342839975212301630723305670868144652445155789341332350048045208193306650096612977274649547561785073221997120433237227113007623135283421640765283029718742436808664900470577951521927318637479871699208829385994841252381825258775525399788067255742725366234239700940334429515756252439632949645492807767260159282194041430695748812909069682381700951390353670360948293377333183163171592722918221077169872375060206054643704617123132819232828854927883974128370285210584512808261233655645377670366487516763384827707968876696437189814020746442876527653260301252510837827715769931520304328005023389439587778752196371059384355489269925894920777319369348131874958879101069922308911792077526642266281996915331864549878658796156808093979261595983199036894822112674496886635632665900479511292787433231377880978519293717082604029129213378675801954772135037687502777328250541427337666779806838362483164031074227068621473196479757814377641240321481375223589864477635120743365927548165973641768505656367428950221106797984938346574922398253343535258276119946645375973976227944066033441341418934888852326155568796939459858951505632211730653689590681866116346516333291931205514691947792927260993151293384508596783475145958021968598814869576849037488447618051340413189464624900434427290198418540303769317296677443919197131745838837601284870643857380495571112311998628564110204467537114902138178446210837979267221702856924264929368216155560152972227577482070888402018610736177161090762155352244698241838719127533739018714976099555322562400525708890060352819600988314162045261739075824328410902446269726719172625691617157465670533815665840080417809423704341162688614551734014510009170861734639378869924372605535013617291732127602590945695335427593219546975474355385435996062644997802932697663051639826024508249828573123161283693755340657381776715999198774926003108242029620936688570297295556614505711102781798082479913241012134420613985677545547599930974836668138582991825367237973210870074424896224692951790985925312613911576095157999619765038325001078173683109354703772678196603127420340400660754341236476006418349594912140895336612828705235784202825844309399079675295737199388464594678118052035429046349378781882885037863691743133803733206993733414184456021752830562641848312016547323320226339192927022724074425215119799118927160448768605273114435265235911741805897449193354168854996361799590900699726039810123970798719605024055188880039621645944310420377783908293830043663070390864314371621704915029005831452037575647551963161875544790637282774708379441643521925443264042372679361553300603440516589144458679385893163416761955855393702309227508169112322150033502301238993958548750447683942993671236450889925673847862535678453724474297513076244476054319423340582742071357327841472282008035044995004215196704638929127369734295937846399696813268631293100681063285947377099333482568040272945344415919627376494660916161928891438210737590665076719000789792636446070812496709600546981377221607154254743414468370698147275709564847938982559199842086830190607846469685185682149899702856647832501874603643162183886835722020841679537664335600256933524648421690335058415148658044729543166284798725764965645550242808085774671988489137606326838892660394624299319684579664305935223808168598727846121369264252619574076371539008583371120019023967835017867167521918468560118504571298388968701763296175860793119312376660657173339804395288877380725086594616303136433530273892086829658890838044297770641694604331806539119587715297490971014597652350929052823182298859624364160836945049056904229039567527338209009257944012278833172546137834598401723691921544532013659889392846166456964558500901652641947116819333740671012078461019247104782001311509632951637306746732306947404805606839880431351573553693735959253111199005921960974435461720325263786662162578335933747728997045132079850841188046133908303691417819201747857600262141730125048436354112103057689765545566744459734791480772621613565145730177041493183598199635148960020924205025093006627042866369716213679894579494229477179188180343901781309432085685426759636846811736681967567412748052711018466374210945813179189982922330817751407275766514701995621755869662888138104932648678789974266433285142401804412043578282476333628206106403853815704196921771977783838860388086859516177024978456666359188696784022371301651037192157757159007783603753362408287258746442965705994042237415822211039073158967539770848195419352629943150483657699879211622637967422111070594722314284916344079567226700478649779927885215132069297986992703536795850141401529717961697952887464459862264326260827025519621199850481749676995544993771447644731324820891353424389050552418370566758278348869581599884483875518997479242757447724480344032406359533612806972888396047332918178085204484318989859562173202090671022918960971809631512588749272858937373052753651978860457046078214993215717113634430674812521482299255429459820738090258423916274369626633846542380407223122555050200275836767510994436680971587623364301597156303813709253728234266773861847863315816904628561566679105142340823069533024507976929433752283557502822412804543793364194179946005521525001372866236856119908350739466639544733790023893286821842796960699999641280959400697853605858215807556989340554084967411692144714789723825340106226039219984473943818608749480590304327776504515536955166923570517589348254761051248407617163971078677927834885789038401547826079894648475409752240100314255819269788880903213380714932782570307381757621228474828858708178104473171188482142645769036539219284441099253321835034076348326562788284314395618690847" ;;
